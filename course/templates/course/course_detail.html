{% extends "base.html" %}

{% block title %}course_detail{% endblock %}
{% load staticfiles %}
{% block content %}
<!-- <link href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
  <script src="//netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script> -->


  <!-- 지도 -->
  <style type="text/css">
    .map-responsive{
        overflow:hidden;
        padding-bottom:50%;
        position:relative;
        height:0;
    }
    .map-responsive iframe{
        left:0;
        top:0;
        height:100%;
        width:100%;
        position:absolute;
    }
  </style>
  <!-- 갤러리 -->
  <style class="cp-pen-styles"> 
  @import "https://fonts.googleapis.com/css?family=Montserrat:400,700|Raleway:300,400";
  /* colors */
  html {
    width: 100%;
    height: 100%;
  }

  body {
    background: #fff;
    color: #333;
    font-family: "Raleway";
    height: 100%;
  }
  /*body h1 {
    text-align: center;
    color: #428BFF;
    font-weight: 300;
    padding: 40px 0 20px 0;
    margin: 0;
  }*/

  .gallery {
    /*left: 50%;
    -webkit-transform: translateX(-50%);
            transform: translateX(-50%);*/
    position: relative;
    background: white;
    width: 100%;
    /*box-shadow: 0 14px 28px rgba(0, 0, 0, 0.25), 0 10px 10px rgba(0, 0, 0, 0.22);*/
    border-radius: 5px;
  }
  .gallery input[name$="control"] {
    display: none;
  }
  .gallery .carousel {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-orient: horizontal;
    -webkit-box-direction: normal;
        -ms-flex-direction: row;
            flex-direction: row;
    position: relative;
    height: 70vh;
    width: 100%;
  }
  .gallery .wrap {
    width: 100%;
    height: 100%;
    position: static;
    margin: 0 auto;
    overflow: hidden;
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-orient: horizontal;
    -webkit-box-direction: normal;
        -ms-flex-direction: row;
            flex-direction: row;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    -ms-flex-wrap: nowrap;
        flex-wrap: nowrap;
    margin-right: 20px;
  }
  .gallery .wrap figure {
    padding: 10px;
    height: 100%;
    min-width: 100%;
    -webkit-transition: opacity 0.25s ease-in-out 0.05s;
    transition: opacity 0.25s ease-in-out 0.05s;
    position: relative;
    left: 0;
    -webkit-transform: translateX(0%);
            transform: translateX(0%);
    box-sizing: border-box;
    text-align: center;
    margin: 0;
    display: block;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    -webkit-box-pack: center;
        -ms-flex-pack: center;
            justify-content: center;
    opacity: 1;
  }
  .gallery .wrap figure label {
    cursor: zoom-in;
    height: auto;
    width: 100%;
    height: 100%;
    position: relative;
    display: block;
  }
  .gallery .wrap figure img {
    cursor: inherit;
    height: auto;
    max-width: 100%;
    max-height: 100%;
    border-radius: 3px;
    margin: 0 auto;
    position: relative;
    top: 50%;
    -webkit-transform: translateY(-50%);
            transform: translateY(-50%);
  }
  .gallery .thumbnails {
    -webkit-box-flex: 1;
        -ms-flex: 1;
            flex: 1;
    min-width: 60px;
    max-height: 100%;
    height: auto;
    -webkit-box-flex: 0;
        -ms-flex-positive: 0;
            flex-grow: 0;
    -ms-flex-item-align: center;
        align-self: center;
    -ms-flex-preferred-size: auto;
        flex-basis: auto;
    position: relative;
    white-space: nowrap;
    overflow: hidden;
    overflow-y: auto;
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-orient: vertical;
    -webkit-box-direction: normal;
        -ms-flex-direction: column;
            flex-direction: column;
    padding: 0 10px;
    z-index: 20;
  }
  .gallery .thumbnails .thumb {
    min-width: 60px;
    height: 60px;
    background-position: center center;
    background-size: cover;
    box-sizing: border-box;
    opacity: 0.7;
    margin: 5px 0;
    -ms-flex-negative: 0;
        flex-shrink: 0;
    left: 0;
    border-radius: 3px;
    cursor: pointer;
    -webkit-transition: all 0.3s ease-in-out;
    transition: all 0.3s ease-in-out;
    background-repeat: no-repeat;
  }
  .gallery .thumbnails .slider {
    position: absolute;
    display: block;
    width: 5px;
    height: calc(60px + 10px);
    z-index: 2;
    margin: 0;
    left: 0;
    -webkit-transition: all 0.33s cubic-bezier(0.3, 0, 0.33, 1);
    transition: all 0.33s cubic-bezier(0.3, 0, 0.33, 1);
  }
  .gallery .thumbnails .slider .indicator {
    width: 100%;
    height: 30px;
    max-height: calc(100% - 10px);
    position: relative;
    top: 50%;
    -webkit-transform: translateY(-50%);
            transform: translateY(-50%);
    background: #428BFF;
    border-radius: 1px;
  }
  .gallery input#fullscreen:checked ~ .wrap figure {
    position: fixed;
    z-index: 10;
    height: 100vh;
    width: 100vw;
    padding: 0;
    top: 50%;
    left: 50%;
    -webkit-transform: translate(-50%, -50%) !important;
            transform: translate(-50%, -50%) !important;
    -webkit-animation-timing-function: ease-in-out;
            animation-timing-function: ease-in-out;
    -webkit-animation-fill-mode: forwards;
            animation-fill-mode: forwards;
  }
  .gallery input#fullscreen:checked ~ .wrap figure label {
    cursor: zoom-out;
  }
  .gallery input#fullscreen:checked ~ .wrap figure label img {
    -webkit-animation: shadow 0.2s;
            animation: shadow 0.2s;
    -webkit-animation-timing-function: ease-in-out;
            animation-timing-function: ease-in-out;
    -webkit-animation-direction: forwards;
            animation-direction: forwards;
    -webkit-animation-fill-mode: forwards;
            animation-fill-mode: forwards;
    border-radius: 0;
  }
  .gallery input#image1:checked ~ .wrap figure {
    -webkit-transform: translateX(0);
            transform: translateX(0);
  }
  .gallery input#image1:checked ~ .wrap figure:not(:nth-of-type(1)) {
    opacity: 0;
  }
  .gallery input#image1:checked ~ .thumbnails .slider {
    -webkit-transform: translateY(0);
            transform: translateY(0);
  }
  .gallery input#image1:checked ~ .thumbnails .thumb:nth-of-type(1) {
    opacity: 1;
    cursor: default;
  }
  .gallery input#image2:checked ~ .wrap figure {
    -webkit-transform: translateX(-100%);
            transform: translateX(-100%);
  }
  .gallery input#image2:checked ~ .wrap figure:not(:nth-of-type(2)) {
    opacity: 0;
  }
  .gallery input#image2:checked ~ .thumbnails .slider {
    -webkit-transform: translateY(100%);
            transform: translateY(100%);
  }
  .gallery input#image2:checked ~ .thumbnails .thumb:nth-of-type(2) {
    opacity: 1;
    cursor: default;
  }
  .gallery input#image3:checked ~ .wrap figure {
    -webkit-transform: translateX(-200%);
            transform: translateX(-200%);
  }
  .gallery input#image3:checked ~ .wrap figure:not(:nth-of-type(3)) {
    opacity: 0;
  }
  .gallery input#image3:checked ~ .thumbnails .slider {
    -webkit-transform: translateY(200%);
            transform: translateY(200%);
  }
  .gallery input#image3:checked ~ .thumbnails .thumb:nth-of-type(3) {
    opacity: 1;
    cursor: default;
  }
  .gallery input#image4:checked ~ .wrap figure {
    -webkit-transform: translateX(-300%);
            transform: translateX(-300%);
  }
  .gallery input#image4:checked ~ .wrap figure:not(:nth-of-type(4)) {
    opacity: 0;
  }
  .gallery input#image4:checked ~ .thumbnails .slider {
    -webkit-transform: translateY(300%);
            transform: translateY(300%);
  }
  .gallery input#image4:checked ~ .thumbnails .thumb:nth-of-type(4) {
    opacity: 1;
    cursor: default;
  }

  @-webkit-keyframes full {
    from {
      -webkit-transform: translate(-50%, -50%) scale(0.8);
              transform: translate(-50%, -50%) scale(0.8);
    }
    to {
      -webkit-transform: translate(-50%, -50%) scale(1);
              transform: translate(-50%, -50%) scale(1);
    }
  }

  @keyframes full {
    from {
      -webkit-transform: translate(-50%, -50%) scale(0.8);
              transform: translate(-50%, -50%) scale(0.8);
    }
    to {
      -webkit-transform: translate(-50%, -50%) scale(1);
              transform: translate(-50%, -50%) scale(1);
    }
  }
  @-webkit-keyframes shadow {
    from {
      box-shadow: 0 0 0 100vmin rgba(24, 33, 45, 0), 0 0 10vmin rgba(13, 21, 31, 0);
    }
    to {
      box-shadow: 0 0 0 100vmin rgba(24, 33, 45, 0.6), 0 0 10vmin rgba(13, 21, 31, 0.6);
    }
  }
  @keyframes shadow {
    from {
      box-shadow: 0 0 0 100vmin rgba(24, 33, 45, 0), 0 0 10vmin rgba(13, 21, 31, 0);
    }
    to {
      box-shadow: 0 0 0 100vmin rgba(24, 33, 45, 0.6), 0 0 10vmin rgba(13, 21, 31, 0.6);
    }
  }
  </style>

  <!-- 관심버튼 -->
	<style type="text/css">

    .checkbox.custom {
      float: left;
      margin: 0;
      padding: 0;
      display: block;
      width: 100%;
      margin-bottom: 20px;
    }
  
    input[type="checkbox"].custom {
      margin-left: 0;
      padding: 0;
    }
  
    input[type=checkbox].css-checkbox {
      position: absolute;
      overflow: hidden;
      clip: rect(0 0 0 0);
      height: 1px;
      width: 1px;
      margin: -1px;
      padding: 0px;
      border: 0;
    }
  
    input[type=checkbox].css-checkbox+label.css-label-yellow{
      padding-left: 40px;
      height: 40px;
      display: inline-block;
      line-height: 40px;
      background-repeat: no-repeat;
      background-position: 0 0;
      font-size: 15px;
      vertical-align: middle;
      cursor: pointer;
      opacity: 1;
    }
  
    input[type=checkbox].css-checkbox+label.css-label-yellow:hover{
    /*   opacity: 0.5; */ /* 선택적 사용 */
    }
  
    input[type=checkbox].css-checkbox:checked+label.css-label-yellow {
      background-position: 0 -40px;
    }
  
    .css-label-yellow {
      background-image: url(https://i.imgur.com/kguopWl.png);
    }
    </style>
  <style type="text/css">
    #rowContainer{
      border-color: white;
    }
  </style>
<!--  -->
    <!-- Page Content -->
 <div class="container">

      <div class="row">

        <!-- Blog Entries Column -->
        <div class="col-md-8" id="rowContainer">

          <h3 class="my-4">+{{ course.cname }}+
            <small>{{ course.name }}</small>
          </h3>
          <hr>
          <div class="card mb-4">
            <img class="card-img-top" src="{{ course.image.thumb_url }}" alt="baking" style="height: 500px; width: 500px;">
            <div class="card-body">
              <h4 class="card-title">{{ course.details }}</h4>
              <!-- <a href="#" class="btn btn-primary">Xem tiếp →</a> -->
            </div>
            <br>
            <hr>
            <!-- 일정 -->
            <h4>일정</h4>
            <div class="container">
            <div class="row">
            <div class="col-md-5">	
            <table class="table table-list-search">
            	<thead>
            		<tr>
            			<th>시간/요일</th>
            			<th>월</th>
            			<th>화</th>
            			<th>수</th>
            			<th>목</th>
            			<th>금</th>
            			<th>토</th>
            			<th>일</th>
            		</tr>
            	</thead>
            	<tbody>
            	    <tr>
            	        <td>10:00~12:00</td>
            	        <td>X</td>
            	        <td>X</td>
            	        <td>O</td>
            	        <td>X</td>
            	        <td>X</td>
            	        <td>O</td>
            	        <td>X</td>
            	    </tr>                    
            	    <tr>
            	        <td>13:00~15:00</td>
            	        <td>X</td>
            	        <td>X</td>
            	        <td>O</td>
            	        <td>X</td>
            	        <td>X</td>
            	        <td>O</td>
            	        <td>X</td>
            	    </tr>
            	    <tr>
            	        <td>15:00~17:00</td>
            	        <td>X</td>
            	        <td>X</td>
            	        <td>O</td>
            	        <td>X</td>
            	        <td>X</td>
            	        <td>O</td>
            	        <td>X</td>
            	    </tr>                 
            	 </tbody>
            </table></div></div></div>
            <br>
            <hr>
            <!-- 지도 -->
            <h4>위치</h4>
            <div class="map-responsive">
            	<iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3162.8688994710333!2d127.04771851557271!3d37.55815243236554!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x357ca4a55b2f2d93%3A0xffdfb5c8c57860f5!2z7ZWc7JaR7Jes7J6Q64yA7ZWZ6rWQ!5e0!3m2!1sko!2skr!4v1526458168670" width="600" height="450" frameborder="0" style="border:0" allowfullscreen></iframe>
              <!--  <iframe src="https://www.google.com/maps/embed?pb=!1m10!1m8!1m3!1d6030.418742494061!2d-111.34563870463673!3d26.01036670629853!3m2!1i1024!2i768!4f13.1!5e0!3m2!1ses-419!2smx!4v1471908546569" width="600" height="450" frameborder="0" style="border:0" allowfullscreen></iframe> -->
            </div>
            <br>
            <hr>
            <!-- 갤러리 -->
            <h4>갤러리</h4>
            <section class="gallery">
              <div class="carousel">
                
                <input type="radio" id="image1" name="gallery-control" checked>
                <input type="radio" id="image2" name="gallery-control">
                <input type="radio" id="image3" name="gallery-control">
                <input type="radio" id="image4" name="gallery-control">
                
                
                <input type="checkbox" id="fullscreen" name="gallery-fullscreen-control"/>
                
                <div class="wrap">

                  {% for gallery in course.gallery_set.all %}
                  <figure>
                    <label for="fullscreen">
                      <img src="{{ gallery.image1.thumb_url }}" alt="image1" style="width: 500px; height: 500px;"/>
                    </label>
                  </figure>
                  
                  <figure>
                    <label for="fullscreen">
                      <img src="{{ gallery.image2.thumb_url }}" alt="image2" style="width: 500px; height: 500px;"/>
                    </label>
                  </figure>

                  <figure>
                    <label for="fullscreen">
                      <img src="{{ gallery.image3.thumb_url }}" alt="image3" style="width: 500px; height: 500px;"/>
                    </label>
                  </figure>

                  <figure>
                    <label for="fullscreen">
                      <img src="{{ gallery.image4.thumb_url }}" alt="image4" style="width: 500px; height: 500px;"/>
                    </label>
                  </figure>
                  {% endfor %}

                </div>
                
                <div class="thumbnails">
                  
                  <div class="slider"><div class="indicator"></div></div>
                  {% for gallery in course.gallery_set.all %}
                  <label for="image1" class="thumb" style="background-image: url('{{ gallery.image1.thumb_url }}')"></label>
                  
                  <label for="image2" class="thumb" style="background-image: url('{{ gallery.image2.thumb_url }}')"></label>
                  
                  <label for="image3" class="thumb" style="background-image: url('{{ gallery.image3.thumb_url }}')"></label>
                    
                  <label for="image4" class="thumb" style="background-image: url('{{ gallery.image4.thumb_url }}')"></label>
                  {% endfor %}
                </div>
              </div>
              </div>
            </section>
            <hr>
            <br/>
            <div>
            {% load disqus_tags %}
            {% disqus_show_comments %}
            </div>

          <!-- Pagination -->
          <ul class="pagination justify-content-center mb-4">
            <li class="page-item">
              <a class="page-link" href="#">← 이전</a>
            </li>
            <li class="page-item disabled">
              <a class="page-link" href="#">다음 →</a>
            </li>
          </ul>

        </div>
        <div class="col-md-4">
          <div class="card my-4">
            <h4 class="card-header">
                <strong>클래스 정보</strong> 
            </h4>
             <div class="project">
                <figure class="img-responsive">

                    <img href="#" src="{% static 'img/pr.jpg' %}" width="100%" height="100%">
                    <span class="actions">
                         <span class="text-capitalize">
                         <p>클래스 이름; {{ course.cname }}</p>
                         <p>강사 이름; <a href="#">{{ course.name }}</a></p>
                     	 <p>가격; {{ course.cost }}원</p>
                        <p>클래스 기간; {{ course.startdate }} ~ {{ course.enddate }}</p>
                       <p>최소 인원; {{ course.minperson }}</p>
                       <p>최대 인원; {{ course.maxperson }}</p>
                     	 <p>장소; {{ course.place }}</p>
                 		</span>

                    </span>
                    <br>

                    <p><strong>시간/날짜 선택</strong></p>
                      
                    <form>
    
                      <div ng-app="myApp" ng-controller="myCntrl">
                      Date: 
                          <input type="text" uib-datepicker-popup="{{dateformat}}" min-date="mindate" max-date="maxdate" ng-model="dt" is-open="showdp" />
                          <span>
                              <button type="button" class="btn btn-default" ng-click="showcalendar($event)">
                                  <i class="glyphicon glyphicon-calendar"></i>
                              </button>
                          </span>
                      </div>
                      <script language="javascript">
                          angular.module('myApp', ['ngAnimate', 'ui.bootstrap']);
                          angular.module('myApp').controller('myCntrl', function ($scope) {
                              $scope.today = function () {
                                  $scope.dt = new Date();
                              };
                              $scope.mindate = Date();
                              $scope.maxdate = Date("{{ course.enddate }}");
                              $scope.dateformat="yyyy/MM/dd";
                              $scope.today();
                              $scope.showcalendar = function ($event) {
                                  $scope.showdp = true;
                              };
                              $scope.showdp = false;
                          });
                      </script>
                      </form>

                    <br>
                    <div class="btn-group btn-group-default"><p>시간</p>
                     	  <button class="btn btn-default" type="button">선택</button>
                     	  <button data-toggle="dropdown" class="btn btn-default dropdown-toggle" type="button"><!-- <span class="caret"></span> -->
                        </button>
                        {% for schedule in course.schedule_set.all %}
                     	  <ul class="dropdown-menu">
                     		  <li><a>{{ schedule.starttime }}~{{ schedule.endtime }}</a></li>
                        </ul>
                        {% endfor %}
                       </div>
                	</figure>
        <br>
        <div class="checkbox custom">
          <a href="{% url 'enrol:add' course.pk %}" class="btn btn-default pull-right" style="padding: 12px 15px">신청하기</a>
                <input id="box2" class="css-checkbox" type="checkbox" name="{{ course.id }}"/>
                <label id="count{{ course.id }}" name="{{ course.id }}" for="box2" class="css-label-yellow">좋아요수 : {{ course.total_likes }}</label> 
              
                <script type="text/javascript">
                  // 좋아요 버튼 처리
                  // 버튼 클릭 > ajax통신 (like url로 전달) > views의 like 메소드에서 리턴하는 값 전달받기 > 성공시 콜백 호출
                  $('.css-label-yellow').click(function(){
                    var pk = $(this).attr('name') // 클릭한 요소의 attribute 중 name의 값을 가져온다.
                    $.ajax({
                        type: "POST", // 데이터를 전송하는 방법을 지정한다.
                        url: "{% url 'course:like' %}", // 통신할 url을 지정한다.
                        data: {'pk': pk, 'csrfmiddlewaretoken': '{{ csrf_token }}'}, // 서버로 데이터를 전송할 때 이 옵션을 사용한다.
                        dataType: "json", // 서버측에서 전송한 데이터를 어떤 형식의 데이터로서 해석할 것인가를 지정한다. 없으면 알아서 판단한다.
                        // 서버측에서 전송한 데이터 views.py like 메소드
                        // context = {'likes_count' : memo.total_likes, 'message' : message}
                        // json.dump(context)를 통해서 json 형식으로 전달된다.
                  
                        success: function(response){ // 성공했을 때 호출할 콜백을 지정한다.
                          id = $(this).attr('name')
                          $('#count'+ pk).html("좋아요수 : "+ response.likes_count);
                          alert(response.message);
                          alert("좋아요수 :" + response.likes_count);
                        },
                        error:function(request,status,error){
                          alert("로그인 후 이용하세요.");
                        }
                    });
                  })
                  </script>

              </div>
            <br>
        </div>
      </div>
      <!-- /.row -->
    </div>

</div>     

{% endblock %} 
